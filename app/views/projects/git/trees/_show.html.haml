%h3= t("layout.projects.files_in_project")
.files
  .l= render 'whereami'
  = render 'fork'
.both

%table#myTable.tablesorter.project{:cellpadding => "0", :cellspacing => "0"}
  %thead
    %tr
      %th.th1= t("layout.projects.filename")
      %th.th2= t("layout.projects.age")
      %th.th3= t("layout.projects.message")
      %th.th4= t("layout.projects.author")
  %tbody
    - if @path.present?
      %tr
        %td
          .pic= image_tag 'folder.png'
          .name= link_to "..", tree_path(@project, @treeish, File.join([@path, ".."].compact))
        %td== &nbsp;
        %td== &nbsp;
        %td== &nbsp;
    - @project.tree_info(@tree, @treeish, @path).each do |node, node_path, commit|
      %tr
        %td
          - if node.is_a? Grit::Tree
            .pic= image_tag 'folder.png'
            .name= link_to(node.name, tree_path(@project, @treeish, node_path), :class => 'files-see')
          - elsif node.is_a? Grit::Submodule
            .pic= image_tag 'folder-submodule.png'
            .name
              - url = node.url(@treeish).gsub(/^git/, 'http').gsub(/.git$/, '')
              = link_to(node.name, url, :class => 'files-see')
              = '@'
              - id = node.id
              = link_to(id[0..6], "#{url}/tree/#{id}", :class => 'files-see')
          - else
            .pic= image_tag 'code.png'
            .name= link_to(node.name, tree_path(@project, @treeish, node_path), :class => 'files-see')
        = render 'commit_info', :commit => commit
